import{r as w,s as v,a as y}from"./element-plus-b263d37b.js";import{x as k}from"./@element-plus-c5e9c587.js";import{u as x}from"./useUpload-9210c0cb.js";import{F as I,r as V,k as S,o as r,S as _,R as d,u as c,c as E,b as U}from"./@vue-2b4cd1a6.js";import{_ as z}from"./_plugin-vue_export-helper-c27b6911.js";const B=["src"],F=I({__name:"uploadSingleImage",props:{modelValue:null,url:{default:"upload/image"},allow_width:{default:2e3},allow_height:{default:2e3},size_error:{default:"文件尺寸过大"},name:{default:"file"}},emits:["update:modelValue","finish"],setup(i,{emit:u}){const a=i,{uploadImage:p}=x(),t=V(a.modelValue);S(()=>a.modelValue,e=>{t.value=e});const m=(e,l)=>{const o=new FileReader;o.readAsDataURL(e),o.onload=n=>{const h=n.target.result,s=new Image;s.src=h,s.onload=async()=>{if(s.width>a.allow_width||s.height>a.allow_height)return y.error(a.size_error);l(e)}}},f=async e=>{const l=new FormData;l.append(a.name,e);const{url:o}=await p(l,a.url+`?name=${a.name}`);t.value=o,u("update:modelValue",t.value),u("finish")},g=async e=>{m(e.file,f)};return(e,l)=>{const o=w,n=v;return r(),_(n,{action:"",class:"avatar-uploader","http-request":g,"show-file-list":!1},{default:d(()=>[c(t)?(r(),E("img",{key:0,src:c(t),class:"avatar"},null,8,B)):(r(),_(o,{key:1,class:"avatar-uploader-icon"},{default:d(()=>[U(c(k))]),_:1}))]),_:1})}}});const A=z(F,[["__scopeId","data-v-3a4d8692"]]);export{A as _};
